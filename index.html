<html>
<style>
td,th {
	font-size: 40px;
}
</style>
<body style="font-size:60px;">
<div style="overflow-x: auto;">
Last Stocks Refresh : Wed Oct 30 18:33:15 IST 2019
<div>Last Price Refresh : <span id="priceUpdateTime"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<button style="font-size:60px;" onclick="location.reload()">Refresh</button>
&nbsp;&nbsp;<a href="options.html"><button style="font-size:60px;">Options</button></a></div>
CE
<table border='1' style='border-collapse:collapse;' width="100%" cellpadding='2' id="resultsList">
</table>
PE
<table border='1' style='border-collapse:collapse;' width="100%" cellpadding='2' id="resultsList1">
</table>
</div>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.7/js/jquery.dataTables.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.3/handlebars.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-sheetrock/1.0.1/dist/sheetrock.min.js"></script>
<script> 
var mySpreadsheet = 'https://docs.google.com/spreadsheets/d/1XFfFwISRvbOlIzVQxyAc7YlB_wTrC9cd5EpKB2Byoy4/edit#gid=0';
var list = ['MGL###CE###1020.00###1000.00','BANKINDIA###CE###72.50###70.00','GODREJCP###CE###740.00###730.00','BHEL###CE###59.00###58.00','ADANIPOWER###CE###67.00###66.00','NBCC###CE###38.00###37.00','TATAMTRDVR###CE###82.50###77.50','EXIDEIND###CE###182.50###180.00','GMRINFRA###CE###21.00###20.00'];
$('#resultsList').sheetrock({
  url: mySpreadsheet,
  query: 'select B,C,F,G,H,M where B is not null ',
  callback: function (error, options, response) {
   $.each(list, function( index, value ) {
    var valArr = value.split("###");
    var clor = "green";
    if(valArr[1] == 'PE') {
     clor = "red";
    }
    $("#resultsList td:contains("+valArr[0]+")").css('color',clor);
    $("#resultsList td:contains("+valArr[0]+")").html(valArr[0] + ' ' + valArr[1] + ' ' + valArr[2]);   
   });
   $("#priceUpdateTime").html($("#resultsList tr:nth-child(2) td:last-child").html());
   $("#resultsList th:last-child, #resultsList td:last-child").remove();
  }
});

mySpreadsheet = 'https://docs.google.com/spreadsheets/d/1mg_FlBlPNeMDgAd-fucmhJvgFbDuT9tmdgX8t4O2__c/edit#gid=0';
$('#resultsList1').sheetrock({
  url: mySpreadsheet,
  query: 'select B,C,F,G,H,M where B is not null ',
  callback: function (error, options, response) {
   $.each(list, function( index, value ) {
    var valArr = value.split("###");
    var clor = "green";
    if(valArr[1] == 'CE') {
     clor = "red";
    }
    $("#resultsList1 td:contains("+valArr[0]+")").css('color',clor);
    $("#resultsList1 td:contains("+valArr[0]+")").html(valArr[0] + ' ' + valArr[1] + ' ' + valArr[2]);  
   });
   $("#priceUpdateTime").html($("#resultsList1 tr:nth-child(2) td:last-child").html());
   $("#resultsList1 th:last-child, #resultsList1 td:last-child").remove();
  }
});
</script>
</html>
