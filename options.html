<html>
<body>
<div id="btw"></div>
CE
<table border='1' style='border-collapse:collapse;font-size:12px;' width="100%" cellpadding='2' id="ceList">
<thead><tr><th>SYMBOL</th><th>STRIKE</th><th>PRICE</th><th>OPEN</th><th>LOW</th></tr></thead>
<tbody>
</tbody>
</table>
PE
<table border='1' style='border-collapse:collapse;font-size:12px;' width="100%" cellpadding='2' id="peList">
<thead><tr><th>SYMBOL</th><th>STRIKE</th><th>PRICE</th><th>OPEN</th><th>LOW</th></tr></thead>
<tbody>
</tbody>
</table>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.7/js/jquery.dataTables.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.3/handlebars.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-sheetrock/1.0.1/dist/sheetrock.min.js"></script>
<script> 
var stocks = [['ACC','CE','1640.00'],['ADANIENT','CE','135.00']];
var out_stocks = [];
$.each(stocks,function(index, value) {
	var query = "underlying="+value[0]+"&instrument=OPTSTK&expiry=30MAY2019&type="+value[1]+"&strike="+value[2];
	$.ajax({
	  type: "GET",
	  dataType: "json",
	  url: "https://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/ajaxFOGetQuoteJSON.jsp?"+query,
	  success: function(msg) {
	     var open = msg.data[0].openPrice;
             var low = msg.data[0].lowPrice;
	     var current = msg.data[0].lastPrice;
             $("#btw").html(current);
             if(low >= open) {
		value.push(current,open,low);
		out_stocks.push(value);
	     } else {
		$(this).remove();	
	     }
	  },
	  error:function (xhr, ajaxOptions, thrownError){
	     alert(xhr.status);
	  }
	});
});

var ce_tbl_body = "";
var pe_tbl_body = "";
$.each(out_stocks, function(index,value) {
	var tbl_row = "";
	$.each(value, function(k , v) {
		if(v != 'CE' && v != 'PE') {
		    tbl_row += "<td>"+v+"</td>";
		}
	})
	if(value[1] == 'CE') {
		ce_tbl_body += "<tr>"+tbl_row+"</tr>";
 	} else {
		pe_tbl_body += "<tr>"+tbl_row+"</tr>";
	}
	          
})
$("#ceList tbody").html(ce_tbl_body);
$("#peList tbody").html(pe_tbl_body);
</script> 
