<html>
	<style>
		td,th {
			font-size: 40px;
		}
	</style>
	<body style="font-size:60px;">
		<div id="btw" style="float:left"></div>
		<div style="float:right"><button onclick="refresh()" style="font-size:60px;">Refresh</button></div>
		<div style="clear:both"></div>
		<div id="buystocks" style="float:left"></div>
		<div style="float:right"><button onclick="clearStocks()" style="font-size:60px;">Clear</button></div>
		<div style="clear:both"></div>
		<div id="autoTradeStocks" style="float:left"></div>
		<div style="float:right">
			<button onclick="startRefresh()" style="font-size:60px;">Auto Refresh ON</button>
			<button onclick="stopRefresh()" style="font-size:60px;">Auto Refresh OFF</button>
		</div>
		<div style="clear:both"></div>
		Today
		<table border='1' style='border-collapse:collapse;' width="100%" cellpadding='2' id="todayList">
			<thead><tr><th>SYMBOL</th><th>STRIKE</th><th>PRICE</th><th>OPEN</th><th>LOW</th><th style="display:none">Pur</th></tr></thead>
			<tbody></tbody>
			</table>
			CE
			<table border='1' style='border-collapse:collapse;' width="100%" cellpadding='2' id="ceList">
			<thead><tr><th>SYMBOL</th><th>STRIKE</th><th>PRICE</th><th>OP/L</th><th>PCL</th><th style="display:none">Pur</th></tr></thead>
			<tbody></tbody>
		</table>
		PE
		<table border='1' style='border-collapse:collapse;' width="100%" cellpadding='2' id="peList">
			<thead><tr><th>SYMBOL</th><th>STRIKE</th><th>PRICE</th><th>OP/L</th><th>PCL</th><th style="display:none">Pur</th></tr></thead>
			<tbody></tbody>
		</table>
	</body>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.7/js/jquery.dataTables.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.3/handlebars.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-sheetrock/1.0.1/dist/sheetrock.min.js"></script>
	<script> 
	var stocks = [['ACC','CE','1620.00'],['ADANIENT','CE','120.00'],['ADANIPORTS','CE','370.00'],['ADANIPOWER','CE','42.50'],['AJANTPHARM','CE','1040.00'],['ALBK','CE','43.00'],['AMARAJABAT','CE','640.00'],['AMBUJACEM','CE','220.00'],['APOLLOHOSP','CE','1160.00'],['APOLLOTYRE','CE','180.00'],['ARVIND','CE','75.00'],['ASHOKLEY','CE','85.00'],['ASIANPAINT','CE','1340.00'],['AUROPHARMA','CE','680.00'],['AXISBANK','CE','750.00'],['BAJAJ-AUTO','CE','3050.00'],['BAJAJFINSV','CE','8000.00'],['BAJFINANCE','CE','3350.00'],['BALKRISIND','CE','800.00'],['BANKBARODA','CE','112.50'],['BANKINDIA','CE','82.50'],['BATAINDIA','CE','1380.00'],['BEL','CE','92.50'],['BEML','CE','840.00'],['BERGEPAINT','CE','305.00'],['BHARATFIN','CE','860.00'],['BHARATFORG','CE','460.00'],['BHARTIARTL','CE','330.00'],['BHEL','CE','63.00'],['BIOCON','CE','530.00'],['BOSCHLTD','CE','17250.00'],['BPCL','CE','380.00'],['BRITANNIA','CE','2800.00'],['BSOFT','CE','90.00'],['CADILAHC','CE','250.00'],['CANBK','CE','250.00'],['CANFINHOME','CE','320.00'],['CASTROLIND','CE','145.00'],['CEATLTD','CE','960.00'],['CENTURYTEX','CE','920.00'],['CESC','CE','670.00'],['CGPOWER','CE','36.00'],['CHENNPETRO','CE','215.00'],['CHOLAFIN','CE','1360.00'],['CIPLA','CE','545.00'],['COALINDIA','CE','240.00'],['COLPAL','CE','1160.00'],['CONCOR','CE','480.00'],['CUMMINSIND','CE','720.00'],['DABUR','CE','375.00'],['DCBBANK','CE','225.00'],['DHFL','CE','120.00'],['DISHTV','CE','30.00'],['DIVISLAB','CE','1640.00'],['DLF','CE','165.00'],['DRREDDY','CE','2750.00'],['EICHERMOT','CE','21000.00'],['ENGINERSIN','CE','110.00'],['EQUITAS','CE','130.00'],['ESCORTS','CE','580.00'],['EXIDEIND','CE','210.00'],['FEDERALBNK','CE','99.00'],['GAIL','CE','335.00'],['GLENMARK','CE','590.00'],['GMRINFRA','CE','16.00'],['GODFRYPHLP','CE','1020.00'],['GODREJCP','CE','670.00'],['GODREJIND','CE','460.00'],['GRASIM','CE','830.00'],['GSFC','CE','97.50'],['HAVELLS','CE','740.00'],['HCLTECH','CE','1080.00'],['HDFC','CE','2000.00'],['HDFCBANK','CE','2380.00'],['HEROMOTOCO','CE','2650.00'],['HEXAWARE','CE','360.00'],['HINDALCO','CE','192.50'],['HINDPETRO','CE','275.00'],['HINDUNILVR','CE','1740.00'],['HINDZINC','CE','255.00'],['IBULHSGFIN','CE','740.00'],['ICICIBANK','CE','390.00'],['ICICIPRULI','CE','340.00'],['IDBI','CE','35.00'],['IDEA','CE','12.00'],['IDFC','CE','36.00'],['IDFCFIRSTB','CE','42.00'],['IFCI','CE','10.00'],['IGL','CE','310.00'],['INDIACEM','CE','97.50'],['INDIANB','CE','240.00'],['INDIGO','CE','1480.00'],['INDUSINDBK','CE','1380.00'],['INFIBEAM','CE','45.00'],['INFRATEL','CE','270.00'],['INFY','CE','730.00'],['IOC','CE','150.00'],['IRB','CE','120.00'],['ITC','CE','302.50'],['JETAIRWAYS','CE','130.00'],['JINDALSTEL','CE','160.00'],['JISLJALEQS','CE','52.50'],['JSWSTEEL','CE','280.00'],['JUBLFOOD','CE','1280.00'],['JUSTDIAL','CE','640.00'],['KAJARIACER','CE','600.00'],['KOTAKBANK','CE','1480.00'],['KSCL','CE','460.00'],['KTKBANK','CE','110.00'],['L%26TFH','CE','117.50'],['LICHSGFIN','CE','500.00'],['LT','CE','1380.00'],['LUPIN','CE','760.00'],['M%26M','CE','620.00'],['M%26MFIN','CE','380.00'],['MANAPPURAM','CE','125.00'],['MARICO','CE','365.00'],['MARUTI','CE','6800.00'],['MCDOWELL-N','CE','540.00'],['MCX','CE','840.00'],['MFSL','CE','410.00'],['MGL','CE','860.00'],['MINDTREE','CE','1000.00'],['MOTHERSUMI','CE','120.00'],['MRF','CE','54500.00'],['MRPL','CE','62.50'],['MUTHOOTFIN','CE','580.00'],['NATIONALUM','CE','49.00'],['NBCC','CE','53.00'],['NCC','CE','95.00'],['NESTLEIND','CE','10500.00'],['NHPC','CE','23.00'],['NIITTECH','CE','1280.00'],['NMDC','CE','92.50'],['NTPC','CE','127.10'],['OFSS','CE','3450.00'],['OIL','CE','177.50'],['ONGC','CE','167.50'],['ORIENTBANK','CE','90.00'],['PAGEIND','CE','23000.00'],['PCJEWELLER','CE','100.00'],['PEL','CE','2150.00'],['PETRONET','CE','240.00'],['PFC','CE','110.00'],['PIDILITIND','CE','1180.00'],['PNB','CE','85.00'],['POWERGRID','CE','182.50'],['PVR','CE','1800.00'],['RAMCOCEM','CE','750.00'],['RAYMOND','CE','800.00'],['RBLBANK','CE','660.00'],['RECLTD','CE','136.50'],['RELCAPITAL','CE','120.00'],['RELIANCE','CE','1280.00'],['RELINFRA','CE','110.00'],['REPCOHOME','CE','420.00'],['RPOWER','CE','7.00'],['SAIL','CE','48.00'],['SBIN','CE','320.00'],['SHREECEM','CE','19500.00'],['SIEMENS','CE','1140.00'],['SOUTHBANK','CE','14.00'],['SRF','CE','2800.00'],['SRTRANSFIN','CE','1040.00'],['STAR','CE','420.00'],['SUNPHARMA','CE','410.00'],['SUNTV','CE','540.00'],['SUZLON','CE','6.00'],['SYNDIBANK','CE','33.00'],['TATACHEM','CE','620.00'],['TATACOMM','CE','560.00'],['TATAELXSI','CE','880.00'],['TATAGLOBAL','CE','240.00'],['TATAMOTORS','CE','180.00'],['TATAMTRDVR','CE','85.00'],['TATAPOWER','CE','62.00'],['TATASTEEL','CE','470.00'],['TCS','CE','2100.00'],['TECHM','CE','790.00'],['TITAN','CE','1200.00'],['TORNTPHARM','CE','1650.00'],['TORNTPOWER','CE','240.00'],['TV18BRDCST','CE','28.00'],['TVSMOTOR','CE','480.00'],['UBL','CE','1380.00'],['UJJIVAN','CE','310.00'],['ULTRACEMCO','CE','4500.00'],['UNIONBANK','CE','72.50'],['UPL','CE','980.00'],['VEDL','CE','165.00'],['VGUARD','CE','210.00'],['VOLTAS','CE','580.00'],['WIPRO','CE','288.75'],['WOCKPHARMA','CE','370.00'],['YESBANK','CE','140.00'],['ZEEL','CE','380.00'],['ACC','PE','1600.00'],['ADANIENT','PE','115.00'],['ADANIPORTS','PE','360.00'],['ADANIPOWER','PE','40.00'],['AJANTPHARM','PE','1020.00'],['ALBK','PE','42.00'],['AMARAJABAT','PE','630.00'],['AMBUJACEM','PE','215.00'],['APOLLOHOSP','PE','1140.00'],['APOLLOTYRE','PE','175.00'],['ARVIND','PE','72.50'],['ASHOKLEY','PE','82.50'],['ASIANPAINT','PE','1300.00'],['AUROPHARMA','PE','670.00'],['AXISBANK','PE','740.00'],['BAJAJ-AUTO','PE','3000.00'],['BAJAJFINSV','PE','7900.00'],['BAJFINANCE','PE','3300.00'],['BALKRISIND','PE','780.00'],['BANKBARODA','PE','110.00'],['BANKINDIA','PE','80.00'],['BATAINDIA','PE','1360.00'],['BEL','PE','91.80'],['BEML','PE','820.00'],['BERGEPAINT','PE','300.00'],['BHARATFIN','PE','840.00'],['BHARATFORG','PE','450.00'],['BHARTIARTL','PE','321.35'],['BHEL','PE','62.00'],['BIOCON','PE','520.00'],['BOSCHLTD','PE','17000.00'],['BPCL','PE','370.00'],['BRITANNIA','PE','2750.00'],['BSOFT','PE','85.00'],['CADILAHC','PE','245.00'],['CANBK','PE','245.00'],['CANFINHOME','PE','310.00'],['CASTROLIND','PE','142.50'],['CEATLTD','PE','950.00'],['CENTURYTEX','PE','900.00'],['CESC','PE','660.00'],['CGPOWER','PE','35.00'],['CHENNPETRO','PE','210.00'],['CHOLAFIN','PE','1350.00'],['CIPLA','PE','540.00'],['COALINDIA','PE','235.00'],['COLPAL','PE','1140.00'],['CONCOR','PE','470.00'],['CUMMINSIND','PE','700.00'],['DABUR','PE','370.00'],['DCBBANK','PE','220.00'],['DHFL','PE','110.00'],['DISHTV','PE','29.00'],['DIVISLAB','PE','1620.00'],['DLF','PE','160.00'],['DRREDDY','PE','2700.00'],['EICHERMOT','PE','20500.00'],['ENGINERSIN','PE','107.50'],['EQUITAS','PE','127.50'],['ESCORTS','PE','560.00'],['EXIDEIND','PE','205.00'],['FEDERALBNK','PE','98.00'],['GAIL','PE','330.00'],['GLENMARK','PE','580.00'],['GMRINFRA','PE','15.00'],['GODFRYPHLP','PE','1000.00'],['GODREJCP','PE','660.00'],['GODREJIND','PE','450.00'],['GRASIM','PE','820.00'],['GSFC','PE','95.00'],['HAVELLS','PE','730.00'],['HCLTECH','PE','1060.00'],['HDFC','PE','1980.00'],['HDFCBANK','PE','2360.00'],['HEROMOTOCO','PE','2600.00'],['HEXAWARE','PE','355.00'],['HINDALCO','PE','190.00'],['HINDPETRO','PE','270.00'],['HINDUNILVR','PE','1720.00'],['HINDZINC','PE','250.00'],['IBULHSGFIN','PE','720.00'],['ICICIBANK','PE','385.00'],['ICICIPRULI','PE','330.00'],['IDBI','PE','34.00'],['IDEA','PE','11.00'],['IDFC','PE','35.00'],['IDFCFIRSTB','PE','41.00'],['IFCI','PE','8.00'],['IGL','PE','305.00'],['INDIACEM','PE','95.00'],['INDIANB','PE','230.00'],['INDIGO','PE','1460.00'],['INDUSINDBK','PE','1360.00'],['INFIBEAM','PE','42.50'],['INFRATEL','PE','265.00'],['INFY','PE','720.00'],['IOC','PE','147.50'],['IRB','PE','115.00'],['ITC','PE','300.00'],['JETAIRWAYS','PE','120.00'],['JINDALSTEL','PE','155.00'],['JISLJALEQS','PE','50.00'],['JSWSTEEL','PE','275.00'],['JUBLFOOD','PE','1260.00'],['JUSTDIAL','PE','620.00'],['KAJARIACER','PE','590.00'],['KOTAKBANK','PE','1440.00'],['KSCL','PE','450.00'],['KTKBANK','PE','107.50'],['L%26TFH','PE','115.00'],['LICHSGFIN','PE','490.00'],['LT','PE','1360.00'],['LUPIN','PE','750.00'],['M%26M','PE','610.00'],['M%26MFIN','PE','370.00'],['MANAPPURAM','PE','122.50'],['MARICO','PE','360.00'],['MARUTI','PE','6700.00'],['MCDOWELL-N','PE','530.00'],['MCX','PE','830.00'],['MFSL','PE','400.00'],['MGL','PE','850.00'],['MINDTREE','PE','980.00'],['MOTHERSUMI','PE','115.00'],['MRF','PE','54000.00'],['MRPL','PE','62.00'],['MUTHOOTFIN','PE','570.00'],['NATIONALUM','PE','48.00'],['NBCC','PE','52.50'],['NCC','PE','92.50'],['NESTLEIND','PE','10400.00'],['NHPC','PE','22.00'],['NIITTECH','PE','1260.00'],['NMDC','PE','90.00'],['NTPC','PE','125.00'],['OFSS','PE','3400.00'],['OIL','PE','175.00'],['ONGC','PE','165.00'],['ORIENTBANK','PE','87.50'],['PAGEIND','PE','22500.00'],['PCJEWELLER','PE','97.50'],['PEL','PE','2100.00'],['PETRONET','PE','235.00'],['PFC','PE','107.50'],['PIDILITIND','PE','1160.00'],['PNB','PE','82.50'],['POWERGRID','PE','180.00'],['PVR','PE','1780.00'],['RAMCOCEM','PE','740.00'],['RAYMOND','PE','780.00'],['RBLBANK','PE','650.00'],['RECLTD','PE','135.00'],['RELCAPITAL','PE','110.00'],['RELIANCE','PE','1260.00'],['RELINFRA','PE','105.00'],['REPCOHOME','PE','400.00'],['RPOWER','PE','5.00'],['SAIL','PE','47.00'],['SBIN','PE','315.00'],['SHREECEM','PE','19250.00'],['SIEMENS','PE','1120.00'],['SOUTHBANK','PE','13.00'],['SRF','PE','2750.00'],['SRTRANSFIN','PE','1020.00'],['STAR','PE','410.00'],['SUNPHARMA','PE','400.00'],['SUNTV','PE','520.00'],['SUZLON','PE','5.00'],['SYNDIBANK','PE','32.00'],['TATACHEM','PE','610.00'],['TATACOMM','PE','550.00'],['TATAELXSI','PE','860.00'],['TATAGLOBAL','PE','235.00'],['TATAMOTORS','PE','175.00'],['TATAMTRDVR','PE','82.50'],['TATAPOWER','PE','61.00'],['TATASTEEL','PE','460.00'],['TCS','PE','2080.00'],['TECHM','PE','780.00'],['TITAN','PE','1180.00'],['TORNTPHARM','PE','1640.00'],['TORNTPOWER','PE','235.00'],['TV18BRDCST','PE','27.00'],['TVSMOTOR','PE','470.00'],['UBL','PE','1360.00'],['UJJIVAN','PE','300.00'],['ULTRACEMCO','PE','4450.00'],['UNIONBANK','PE','70.00'],['UPL','PE','970.00'],['VEDL','PE','160.00'],['VGUARD','PE','205.00'],['VOLTAS','PE','570.00'],['WIPRO','PE','285.00'],['WOCKPHARMA','PE','360.00'],['YESBANK','PE','130.00'],['ZEEL','PE','370.00']];
	var today_stocks = ['MANAPPURAM###PE###122.50','TCS###PE###2080.00','UNIONBANK###PE###70.00','MOTHERSUMI###PE###115.00','KSCL###PE###450.00','DLF###PE###160.00','CADILAHC###PE###245.00','PCJEWELLER###PE###97.50','LUPIN###PE###750.00','SBIN###PE###315.00','EICHERMOT###CE###21000.00','TATACHEM###CE###620.00','HINDUNILVR###CE###1740.00','DCBBANK###CE###225.00','MRF###CE###54500.00','JUSTDIAL###CE###640.00','ADANIPORTS###CE###370.00','ZEEL###CE###380.00','RBLBANK###CE###660.00','PETRONET###CE###240.00'];
	var ce_tbl_body = "";
	var pe_tbl_body = "";
	$.each(stocks, function(index,value) {
		var tbl_row = "";
		var clorstyle = '';
	        $.each(today_stocks, function( index1, value1 ) {
			var valArr = value1.split("###");
			if(valArr[0] == value[0].replace("%26","&")) {
				var clor = "green";
				if(valArr[1] != value[1]) {
					clor = "red";
				}
				clorstyle = 'style=color:'+clor;
			}
		});
	        tbl_row += "<td onclick='buy()' "+clorstyle+">"+value[0].replace("%26","&")+"</td>";
		tbl_row += "<td>"+value[2]+"</td>";
	        var sname = value[0];
	        sname = sname.replace("%26","_AND_");
		tbl_row += "<td id='"+value[1]+"_"+sname+"_current'>"+''+"</td>";
		tbl_row += "<td id='"+value[1]+"_"+sname+"_open'>"+''+"</td>";
		tbl_row += "<td id='"+value[1]+"_"+sname+"_pcl'>"+''+"</td>";
		tbl_row += "<td style='display:none' id='"+value[1]+"_"+sname+"_purchase_price'>"+''+"</td>";
		if(value[1] == 'CE') {
			ce_tbl_body += "<tr id='"+value[1]+"_"+sname+"'>"+tbl_row+"</tr>";
	 	} else {
			pe_tbl_body += "<tr id='"+value[1]+"_"+sname+"'>"+tbl_row+"</tr>";
		}
		          
	})
	$("#ceList tbody").html(ce_tbl_body);
	$("#peList tbody").html(pe_tbl_body);
	
	var today_tbl_body = "";
	$.each(today_stocks, function(index,value) {
		value = value.split('###');
		var tbl_row = "";
		var clorstyle = '';
	        tbl_row += "<td onclick='buy()' "+clorstyle+">"+value[0].replace("%26","&")+' '+value[1]+"</td>";
		tbl_row += "<td>"+value[2]+"</td>";
	        var sname = value[0];
	        sname = sname.replace("%26","_AND_");
		tbl_row += "<td id='T_"+value[1]+"_"+sname+"_current'>"+''+"</td>";
		tbl_row += "<td id='T_"+value[1]+"_"+sname+"_open'>"+''+"</td>";
		tbl_row += "<td id='T_"+value[1]+"_"+sname+"_low'>"+''+"</td>";
		tbl_row += "<td style='display:none' id='T_"+value[1]+"_"+sname+"_purchase_price'>"+''+"</td>";
		today_tbl_body += "<tr id='T_"+value[1]+"_"+sname+"'>"+tbl_row+"</tr>";	          
	});
	$("#todayList tbody").html(today_tbl_body);
	
	$('#buystocks').html(localStorage.getItem('buy_stocks'));
	
	function buy() {
		var str = 'buy ' + $(event.target).parent().attr('id') + ' at ' + $(event.target).next().next().next().next().next().html();
		localStorage.setItem('buy_stocks',localStorage.getItem('buy_stocks') == null ? '' : localStorage.getItem('buy_stocks') +' <br> ' + str);
		$('#buystocks').html(localStorage.getItem('buy_stocks'));
	}
	
	function clearStocks() {
		localStorage.setItem('buy_stocks','');
		$('#buystocks').html(localStorage.getItem('buy_stocks'));
		localStorage.setItem('auto_trade_stocks','');
		$('#autoTradeStocks').html(localStorage.getItem('auto_trade_stocks'));
	}
	
	function trade() {
		$.each(today_stocks,function(index, value) {
			value = value.split('###');
			if(localStorage.getItem('auto_trade_stocks') != null && 
					localStorage.getItem('auto_trade_stocks').indexOf('buy ' + value[0]) > 0 &&
						localStorage.getItem('auto_trade_stocks').indexOf('sell ' + value[0]) > 0) {
				continue;
			}
			var query = "underlying="+value[0]+"&instrument=OPTSTK&expiry=30MAY2019&type="+value[1]+"&strike="+value[2];
			$.ajax({
			  type: "GET",
			  dataType: "json",
			  url: "https://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/ajaxFOGetQuoteJSON.jsp?"+query,
			  success: function(msg) {
			     var open = msg.data[0].openPrice;
		         var low = msg.data[0].lowPrice;
			     var sname = msg.data[0].underlying;//.replace("&","_AND_");
			     var purchase_price = msg.data[0].sellPrice1;
			     var sell_price = msg.data[0].buyPrice1;
			     var optionType = msg.data[0].optionType;
		         try {
				 	open = parseFloat(open);
				 	if(!isFinite(open)) {
				 		return;
				 	}
					var optionType = msg.data[0].optionType;
					var str = 'buy ' + sname + ' ' + optionType + ' at ' + purchase_price;
					if(localStorage.getItem('auto_trade_stocks') == null || localStorage.getItem('auto_trade_stocks').indexOf('buy ' + sname + ' ' + optionType) < 0) {
						localStorage.setItem('auto_trade_stocks',localStorage.getItem('auto_trade_stocks') == null ? '' : localStorage.getItem('auto_trade_stocks') +' <br> ' + str);
						$('#autoTradeStocks').html(localStorage.getItem('auto_trade_stocks'));			
					}
					str = 'sell ' + sname + ' ' + optionType + ' at ' + sell_price;
		            low = parseFloat(low);
					if(low < open || (new Date().getHours() == 15 && new Date().getMinutes() == 15)) {
						if(localStorage.getItem('auto_trade_stocks') == null || localStorage.getItem('auto_trade_stocks').indexOf('sell ' + sname + ' ' + optionType) < 0) {
							localStorage.setItem('auto_trade_stocks',localStorage.getItem('auto_trade_stocks') == null ? '' : localStorage.getItem('auto_trade_stocks') +' <br> ' + str);
							$('#autoTradeStocks').html(localStorage.getItem('auto_trade_stocks'));			
						}
		            }
			     } catch (e) {
				
			     }
			  },
			  error:function (xhr, ajaxOptions, thrownError){
			     $("#btw").html('Error : ' + xhr.status);
			  }
			});
		});
	}
	
	var tradeInterval = '';
	
	function startRefresh() {
		tradeInterval = window.setInterval(function(){ trade(); }, 1000);
	}
	
	function stopRefresh() {
		clearInterval(tradeInterval);
	}
	
	function refreshTodayStocks() {
		$.each(today_stocks,function(index, value) {
			value = value.split('###');
			var query = "underlying="+value[0]+"&instrument=OPTSTK&expiry=30MAY2019&type="+value[1]+"&strike="+value[2];
			$.ajax({
			  type: "GET",
			  dataType: "json",
			  url: "https://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/ajaxFOGetQuoteJSON.jsp?"+query,
			  success: function(msg) {
			     var open = msg.data[0].openPrice;
		         var low = msg.data[0].lowPrice;
			     var current = msg.data[0].lastPrice;
			     var sname = msg.data[0].underlying;
			     var purchase_price = msg.data[0].sellPrice1;
			     sname = sname.replace("&","_AND_");
			     var optionType = msg.data[0].optionType;
		         $("#btw").html('Success : ' + current);
			     $("#T_"+optionType+"_"+sname+"_current").html(current);
			     $("#T_"+optionType+"_"+sname+"_open").html(open);
			     $("#T_"+optionType+"_"+sname+"_low").html(low);
			     $("#T_"+optionType+"_"+sname+"_purchase_price").html(purchase_price);
			     try {
				 	open = parseFloat(open);
					low = parseFloat(low);
					if(low >= open) {
						$("#T_"+optionType+"_"+sname+" :first-child").css('color','green');
					} else {
						$("#T_"+optionType+"_"+sname+" :first-child").css('color','red');
					}
			     } catch (e) {
				
			     }
			  },
			  error:function (xhr, ajaxOptions, thrownError){
			     $("#btw").html('Error : ' + xhr.status);
			  }
			});
		});
	}
	
	function refreshAllStocks() {
		$.each(stocks,function(index, value) {
			var query = "underlying="+value[0]+"&instrument=OPTSTK&expiry=30MAY2019&type="+value[1]+"&strike="+value[2];
			if($("#"+value[1]+"_"+value[0].replace("%26","_AND_")).length <= 0) {
				return true;	
			}
			$.ajax({
			  type: "GET",
			  dataType: "json",
			  url: "https://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/ajaxFOGetQuoteJSON.jsp?"+query,
			  success: function(msg) {
			     var open = msg.data[0].openPrice;
		         var low = msg.data[0].lowPrice;
			     var pcl = msg.data[0].prevClose;
			     var current = msg.data[0].lastPrice;
			     var sname = msg.data[0].underlying;
			     sname = sname.replace("&","_AND_");
			     var optionType = msg.data[0].optionType;
			     var purchase_price = msg.data[0].sellPrice1;
		         $("#btw").html('Success : ' + current);
			     try {
					open = parseFloat(open);
					low = parseFloat(low);
					pcl = parseFloat(pcl);
					current = parseFloat(current);
					if(low >= open) {
						$("#"+optionType+"_"+sname+"_current").html(current);
						$("#"+optionType+"_"+sname+"_open").html(open);
						$("#"+optionType+"_"+sname+"_pcl").html(pcl);
						$("#"+optionType+"_"+sname+"_purchase_price").html(purchase_price);
					} else {
						$("#"+optionType+"_"+sname).remove();
					}
			     } catch (e) {
					$("#"+optionType+"_"+sname).remove();
			     }
			  },
			  error:function (xhr, ajaxOptions, thrownError){
			     $("#btw").html('Error : ' + xhr.status);
			  }
			});
		});
	}
	
	function refresh() {
		refreshTodayStocks();
		//refreshAllStocks();
	}
	refresh();
	</script>
